{
  "hash": "d63cd4f9f4c4a83899befb1a444f3706",
  "result": {
    "engine": "knitr",
    "markdown": "\n\n\n\n# Mini-Project\n\n## Learning Goals {-}\n\n- Apply data wrangling and visualization skills to a new data set\n\n\nCreate a new Rmd file (save it as 11-Mini_Project.Rmd). Put this file in a folder `Assignment_07` in your `COMP_STAT_112` folder.\n\n- Make sure to add alt text using fig.alt!\n\n\n## Data: Kiva {-}\n\n[Kiva](https://www.kiva.org/) is a non-profit that allows people from around the world to lend small amounts to others to start or grow a business, go to school, access clean energy, etc. Since its founding in 2005, more than $1.2 billion in loans to over 3 million borrowers have been funded. In this activity, we'll examine some lending data from 2005-2012. \n\n### Investigate the `partners` Data Table {-}\n\nKiva has field partners who generally act as intermediaries between borrowers and Kiva (lenders). They evaluate borrower risk, post loan requests on Kiva, and process payments. The following command loads a table with [data](data/kiva_partners2.csv) on Kiva's field partners.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npartners <- read_csv(\"https://bcheggeseth.github.io/112_spring_2023/data/kiva_partners2.csv\")\n```\n:::\n\n\n\n\nExamine the [codebook](data/kiva_partners_vars.xlsx) for the `partners` table.   \n\n\n\n\n\n::: {.cell name='Regional distribution'}\n\n```{.exercise .cell-code}\nMake a summary table with only five columns: region (`countries.region`), total number of partners, total number of loans posted, total amount raised, and average loan size per loan posted. \n\nThe four columns after region should all be on a per region basis; for example, the row for Central America should include average loan size per loan posted in Central America. Sort your table by total amount raised.\n\n```\n:::\n\n::: {.cell name='Partners in Africa'}\n\n```{.exercise .cell-code}\nDraw a map of all of the partners in Africa, with the size of the dot corresponding to the amount raised.   \n\n```\n:::\n\n\n\n### Investigate the `loans` Data Table {-}\n\nThe `loans` [table](data/kiva_loans_small.csv) below contains information about individual loans to borrowers.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# a random sample of 10,000\nloans <- read_csv(\"https://bcheggeseth.github.io/112_spring_2023/data/kiva_loans_small.csv\")\n```\n:::\n\n\n\n\nExamine the [codebook](data/kiva_loans_vars.xlsx) for the `loans` table. View the `loans` table and browse through some of the data (e.g., different sectors, uses, countries)\n\n\n\n\n::: {.cell name='Preprocessing'}\n\n```{.exercise .cell-code}\nConsider the `loans` data and perform the following preprocessing steps and save the new data as `loans2`.\n```\n:::\n\n\n\na. Remove all rows where the funded amount is 0.   \nb. Note that the date information about when a loan request was posted is separated out into different fields for year, month, day, hour, etc. It would be more helpful to have a single field for the exact time at which each loan was posted. We'll do this in three steps. First, create (mutate) a new column by pasting together the year, month, and date, separated by hyphens: `post_dt=paste(posted_yr, posted_mo, posted_day, sep='-')`. Second, create a new column with the time: `post_time=paste(posted_hr,posted_min,posted_sec, sep=':')`. Third, using the `ymd_hms` command from `lubridate`, add a new column with the full date (including time of day):  \n`post_date=ymd_hms(paste(post_dt,post_time,sep=' '))`.   \nc. Repeat the previous part to add a column `funded_date` with the exact time at which each loan was funded.   \nd. Create a new table called `loans2` that only contains the following columns from `loans`: loan_id,status,funded_amount,paid_amount,sector,location.country,lat,lon,partner_id,post_date,funded_date   \n\n\n\n\n\n::: {.cell name='Loans by country'}\n\n```{.exercise .cell-code}\nConsider the `loans2` table. \n```\n:::\n\n\n\na. Find the top 5 countries by number of loans.    \nb. Find the top 5 countries by total funded loan amount.   \n\n\n\n\n\n::: {.cell name='Sector analysis'}\n\n```{.exercise .cell-code}\nMake a scatterplot with the number of loans in each sector on the x-axis and the average loan size in each sector on the y-axis. Instead of using points, use text with each sector's name as the glyph.\n```\n:::\n\n\n\n*Hint: start by wrangling the data into glyph-ready form, with one row corresponding to one glyph.*   \n\n\n### Putting them together {-}\n\n\n\n::: {.cell name='Join practice'}\n\n```{.exercise .cell-code}\nJoin the `countries.region` variable from the `partners` table onto the `loans2` table, in order to have a region associated with each loan. Save the output table as `loans3`.  \n\n```\n:::\n\n::: {.cell name='Defaults'}\n\n```{.exercise .cell-code}\nConsider the following:\n```\n:::\n\n\n\na. Starting with `loans3`, create a new table `DefaultData` that only includes those loans whose status is either \"defaulted\" or \"paid\".   \nb. Make a density plot of the funded amount, split by loan status (\"defaulted\" or \"paid\"). That is, your plot should have two separate density curves on top of each other. Interpret the plot.   \n\nc. Make a bar chart with 10 bars, such that each bar is a \\$1000 range of funding amount; that is, the first bar should be for \\$0-\\$1000, the second for \\$1001-\\$2000, and so forth. The bars should all have height equal to 1, but be filled with two colors: one for the percentage of loans in that interval bin that defaulted and one for the percentage that were paid back in full. Interpret your graphic.     \nd. Starting with the data in `DefaultData` from part (a), make a table with four columns: partner_id, number of defaulted loans through that partner, number of loans completely paid back through that partner, and percentage of loans defaulted (the second column divided by the sum of the second and third columns). Sort your table from highest default percentage to lowest, and print out only those with at least a 10% default percentage. *Hint: start by filtering out partners that have not had any defaulted loans.*   \n\n\n\n\n::: {.cell name='Funding time'}\n\n```{.exercise .cell-code}\nConsider the following:\n```\n:::\n\n\n\na. Use the command `days_to_fund = difftime(funded_date, post_date, units=\"days\")` within `mutate()` to add a column to the `loans3` data that has the number of days between the time a loan was posted and the time it was funded. Save your new table as `loans4`.      \nb. The `days_to_fund` should always be positive, but there are some negative values, most likely due to data entry errors. Filter these out of the data table `loans4`.   \nc. Make a bar chart with days to fund by region. Reorder the x-axis so that the regions are in order of ascending days to fund.   \nd. Make a bar chart with days to fund by sector. Reorder the x-axis so that the sectors are in order of ascending days to fund.   \ne. Make a scatterplot with `funded_amount` on the x-axis and `days_to_fund` on the y-axis. Color the points by region and set the transparency to 0.2. Add linear trendlines for each region. What are the trends? \n\n\n\n::: {.cell name='Your Own Question'}\n\n```{.exercise .cell-code}\nNow that you are more familiar with the data, investigate your own research question and address it with a summary table or a data visualization.\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{},\"value\":[]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}